<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chess Game</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .square.highlight { background-color: #ffdd57 !important; }
    .piece:hover { transform: scale(1.2); transition: transform 0.1s ease; }
    .game-over-message { animation: fadeIn 0.3s ease-in-out; text-align: center; padding: 10px; }
    .piece.dragging { opacity: 0.5; }
    .square { transition: box-shadow 0.1s ease-in-out; }
    .chessboard {
      display: grid;
      grid-template-columns: repeat(8, minmax(0, 1fr));
      grid-template-rows: repeat(8, minmax(0, 1fr));
      width: 400px;
      height: 400px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
      border-radius: 10px;
    }
    .piece.white { color: white; filter: drop-shadow(0 0 2px rgba(0, 0, 0, 1)); }
    .piece.black { color: black; }
    .flipped { transform: rotate(180deg); }
    .square { display: flex; align-items: center; justify-content: center; }
    .square.light { background-color: #f0d9b5; }
    .square.dark { background-color: #b58863; }
    .piece { font-size: 36px; cursor: pointer; }
    .piece.draggable { cursor: grab; }
    .dragging { opacity: 0.5; }
    .flipped .piece { transform: rotate(180deg); }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center bg-gradient-to-br from-[#1e293b] via-[#0f172a] to-[#020617] text-white">

  <div class="flex gap-6">
    <!-- Chessboard -->
    <div class="chessboard"></div>

    <!-- Chatbox -->
    <div class="flex flex-col w-72 h-[400px] bg-gray-800 rounded-lg shadow-lg">
      <div class="flex items-center justify-between bg-gray-900 px-3 py-2 rounded-t-lg">
        <h2 class="font-bold text-lg">Game Chat</h2>
      </div>

      <!-- Chat Messages -->
      <div id="chat-messages" class="flex-1 overflow-y-auto p-3 space-y-2 text-sm"></div>

      <!-- Input Box -->
      <form id="chat-form" class="flex p-2 border-t border-gray-700">
        <input id="chat-input" type="text" placeholder="Type a message..."
          class="flex-1 p-2 rounded-l bg-gray-700 text-white focus:outline-none">
        <button type="submit"
          class="px-4 py-2 bg-blue-600 rounded-r hover:bg-blue-700">Send</button>
      </form>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
  <script src="/js/chessgame.js"></script>

  <!-- Chat Script -->
  <script>
    const socket = io();

    const chatForm = document.getElementById("chat-form");
    const chatInput = document.getElementById("chat-input");
    const chatMessages = document.getElementById("chat-messages");

    // Send message
    chatForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const msg = chatInput.value.trim();
      if (msg !== "") {
        socket.emit("chatMessage", msg);
        chatInput.value = "";
      }
    });

    // Receive message
    socket.on("chatMessage", (data) => {
      const msgDiv = document.createElement("div");
      msgDiv.classList.add("p-2", "rounded", data.sender === "You" ? "bg-blue-600 self-end text-right" : "bg-gray-700");
      msgDiv.innerHTML = `<strong>${data.sender}:</strong> ${data.text}`;
      chatMessages.appendChild(msgDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    });
  </script>
</body>
</html>
